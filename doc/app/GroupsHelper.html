<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">

<title>module GroupsHelper - Rails Application Documentation</title>

<link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script type="text/javascript" charset="utf-8" src="./js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/darkfish.js"></script>


<body id="top" class="module">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="./index.html">Home</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>app/helpers/groups_helper.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    
    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-i-get_owner_email">#get_owner_email</a>
    
    <li><a href="#method-i-group_list">#group_list</a>
    
    <li><a href="#method-i-resource_list">#resource_list</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="./README_rdoc.html">README</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="./Ability.html">Ability</a>
  
    <li><a href="./Account.html">Account</a>
  
    <li><a href="./AccountsController.html">AccountsController</a>
  
    <li><a href="./AccountsHelper.html">AccountsHelper</a>
  
    <li><a href="./AdminController.html">AdminController</a>
  
    <li><a href="./AdminHelper.html">AdminHelper</a>
  
    <li><a href="./ApplicationController.html">ApplicationController</a>
  
    <li><a href="./ApplicationHelper.html">ApplicationHelper</a>
  
    <li><a href="./Contact.html">Contact</a>
  
    <li><a href="./ContactMailer.html">ContactMailer</a>
  
    <li><a href="./Group.html">Group</a>
  
    <li><a href="./GroupMailer.html">GroupMailer</a>
  
    <li><a href="./GroupRelations.html">GroupRelations</a>
  
    <li><a href="./GroupsController.html">GroupsController</a>
  
    <li><a href="./GroupsHelper.html">GroupsHelper</a>
  
    <li><a href="./HomeController.html">HomeController</a>
  
    <li><a href="./HomeHelper.html">HomeHelper</a>
  
    <li><a href="./Oops.html">Oops</a>
  
    <li><a href="./Project.html">Project</a>
  
    <li><a href="./ProjectsController.html">ProjectsController</a>
  
    <li><a href="./ProjectsHelper.html">ProjectsHelper</a>
  
    <li><a href="./SharedClassMethods.html">SharedClassMethods</a>
  
    <li><a href="./SharedInstanceMethods.html">SharedInstanceMethods</a>
  
    <li><a href="./Subscription.html">Subscription</a>
  
    <li><a href="./SubscriptionsController.html">SubscriptionsController</a>
  
    <li><a href="./SubscriptionsHelper.html">SubscriptionsHelper</a>
  
    <li><a href="./User.html">User</a>
  
    <li><a href="./UserMailer.html">UserMailer</a>
  
    <li><a href="./UsersController.html">UsersController</a>
  
    <li><a href="./UsersHelper.html">UsersHelper</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="module">module GroupsHelper</h1>

  <div id="description" class="description">
    
  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    <!-- Methods -->
    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-get_owner_email" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_owner_email</span><span
            class="method-args">(group)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The get_owner is a view helper method that will return either the email
address of the group owner or “None”.</p>
          

          
          <div class="method-source-code" id="get_owner_email-source">
            <pre><span class="ruby-comment"># File app/helpers/groups_helper.rb, line 7</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_owner_email</span>(<span class="ruby-identifier">group</span>)
        <span class="ruby-keyword">begin</span> 
                <span class="ruby-keyword">return</span> <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">group</span>.<span class="ruby-identifier">owner_id</span>).<span class="ruby-identifier">email</span>
        <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Mongoid</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span><span class="ruby-operator">::</span><span class="ruby-constant">DocumentNotFound</span>
                <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;None&quot;</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- get_owner_email-source -->
          
        </div>

        

        
      </div><!-- get_owner_email-method -->

    
      <div id="method-i-group_list" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">group_list</span><span
            class="method-args">(params)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The <a href="GroupsHelper.html#method-i-group_list">#group_list</a> method
will return a list of groups that are owned by the user. If no groups are
found for the user then nil will be returned. The group list will return an
array of hashes. Each array element will contain a hash of the form:</p>

<p><a href="http://0">group_list</a> = { id: 1, related: true, label: 'name'}</p>

<p>The id: will be the group.id. The related: key will be either true or false
depending on whether the group is already related to the resource. The
label: key will hold the name of the group.</p>

<p>The method takes a parameter hash with the following keys:</p>
<ul><li>
<p>user: The owner of the groups</p>
</li><li>
<p>resource: The resource to which we want to relate the groups. This
parameter will be used to see if the group is already related.</p>
</li></ul>
          

          
          <div class="method-source-code" id="group_list-source">
            <pre><span class="ruby-comment"># File app/helpers/groups_helper.rb, line 32</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">group_list</span>(<span class="ruby-identifier">params</span>)
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">owned_groups</span> = <span class="ruby-constant">Group</span>.<span class="ruby-identifier">owned_groups</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:user</span>])
<span class="ruby-identifier">resource</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:resource</span>]

            <span class="ruby-ivar">@list_name</span> = <span class="ruby-string">'Available groups'</span>  
            <span class="ruby-identifier">group_ids</span> = <span class="ruby-identifier">resource</span>.<span class="ruby-identifier">group_ids</span>
            <span class="ruby-identifier">group_list</span> = []
            <span class="ruby-identifier">owned_groups</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">group</span><span class="ruby-operator">|</span>  
              <span class="ruby-identifier">group_list</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">group</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">related</span><span class="ruby-operator">:</span> <span class="ruby-identifier">group_ids</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">group</span>.<span class="ruby-identifier">id</span>) , 
                <span class="ruby-identifier">label</span><span class="ruby-operator">:</span> <span class="ruby-identifier">group</span>.<span class="ruby-identifier">name</span>}
            <span class="ruby-keyword">end</span>
            
            <span class="ruby-keyword">return</span> <span class="ruby-identifier">group_list</span>       
      
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Mongoid</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span><span class="ruby-operator">::</span><span class="ruby-constant">DocumentNotFound</span>
                  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
          <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span></pre>
          </div><!-- group_list-source -->
          
        </div>

        

        
      </div><!-- group_list-method -->

    
      <div id="method-i-resource_list" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">resource_list</span><span
            class="method-args">(params)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The <a href="GroupsHelper.html#method-i-resource_list">#resource_list</a>
method will set an instance variable called  @resources to hold an array of
hashes. Each array element holds resource information in a hash. The user
can select multiple  resources to share with the group. This instance
variable is used  by the form partial. The example array of hash values are
shown below:</p>

<p>@<a href="http://0">resources</a> = { id: 1, related: true, label: ‘name’}</p>

<p>The ‘related’ key/value is used to indicae whether the resource  is already
related to the group. Its value can either be true or  false. The ‘label’
key/value is text choice that will be displayed to the user.</p>

<p>This method takes a parameter hash with the following key/value pairs</p>
<ul><li>
<p>class: A text value with the name of the resource class to list</p>
</li><li>
<p>group: The group object to which we want to relate the resource</p>
</li><li>
<p>user_id: The user_id to which the resource and group should belong</p>
</li></ul>

<p>You will need to customize this method to list the resources that you want
to share with the group.</p>
          

          
          <div class="method-source-code" id="resource_list-source">
            <pre><span class="ruby-comment"># File app/helpers/groups_helper.rb, line 76</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">resource_list</span>(<span class="ruby-identifier">params</span>)
  <span class="ruby-identifier">rclass</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:class</span>]
  <span class="ruby-identifier">user_id</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:user_id</span>]
  <span class="ruby-identifier">group</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:group</span>]
  
  <span class="ruby-ivar">@list_name</span> = <span class="ruby-node">&quot;Available #{rclass.capitalize.pluralize}&quot;</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">resources</span> = <span class="ruby-constant">Object</span>.<span class="ruby-identifier">const_get</span>(<span class="ruby-identifier">rclass</span>).<span class="ruby-identifier">where</span>(<span class="ruby-identifier">user_id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">user_id</span>)

    <span class="ruby-comment"># Get list of resource ids assoicated with the group</span>
    <span class="ruby-comment"># We construct the call to specify the resource class using</span>
    <span class="ruby-comment"># the send and Object.const_get methods.</span>
    <span class="ruby-identifier">related_resource_ids</span> = <span class="ruby-identifier">group</span>.<span class="ruby-identifier">send</span>(
      <span class="ruby-constant">Object</span>.<span class="ruby-identifier">const_get</span>(<span class="ruby-identifier">rclass</span>).<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">+</span> <span class="ruby-string">'_ids'</span>)

    <span class="ruby-identifier">resource_list</span> = []
    <span class="ruby-identifier">resources</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resource</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">resource_label</span> = <span class="ruby-identifier">resource</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:name</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">resource</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">resource</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span>
      
      <span class="ruby-identifier">resource_list</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">resource</span>.<span class="ruby-identifier">id</span>, 
        <span class="ruby-identifier">related</span><span class="ruby-operator">:</span> <span class="ruby-identifier">related_resource_ids</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">resource</span>.<span class="ruby-identifier">id</span>),
        <span class="ruby-identifier">label</span><span class="ruby-operator">:</span> <span class="ruby-identifier">resource_label</span> }
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">return</span> <span class="ruby-identifier">resource_list</span>
    
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Mongoid</span><span class="ruby-operator">::</span><span class="ruby-constant">Errors</span><span class="ruby-operator">::</span><span class="ruby-constant">DocumentNotFound</span>
                <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- resource_list-source -->
          
        </div>

        

        
      </div><!-- resource_list-method -->

    
    </section><!-- public-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.2.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

